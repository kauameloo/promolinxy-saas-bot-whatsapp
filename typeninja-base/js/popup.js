var activeTab,freeVersion=!0,wppInjected=!1;function saveOptions(){localStorage.setItem("urlAPI",document.getElementById("urlAPI").value),localStorage.setItem("activeDelay",document.getElementById("activeDelay").checked),localStorage.setItem("delayPerText",document.getElementById("delayPerText").value),localStorage.setItem("delayPerAudio",document.getElementById("delayPerAudio").value),localStorage.setItem("delayPerMessage",document.getElementById("delayPerMessage").value),localStorage.setItem("linkList",document.getElementById("linkList").value),localStorage.setItem("endChatAfterSeconds",document.getElementById("endChatAfterSeconds").value),localStorage.setItem("stopChatAfterEnding",document.getElementById("stopChatAfterEnding").checked)}function loadOptions(){document.getElementById("urlAPI").value=localStorage.getItem("urlAPI")||"",document.getElementById("activeDelay").checked=JSON.parse(localStorage.getItem("activeDelay"))||!1,document.getElementById("delayPerText").value=localStorage.getItem("delayPerText")||5,document.getElementById("delayPerAudio").value=localStorage.getItem("delayPerAudio")||10,document.getElementById("delayPerMessage").value=localStorage.getItem("delayPerMessage")||2,document.getElementById("linkList").value=localStorage.getItem("linkList")||"",document.getElementById("endChatAfterSeconds").value=localStorage.getItem("endChatAfterSeconds")||0,document.getElementById("stopChatAfterEnding").checked=JSON.parse(localStorage.getItem("stopChatAfterEnding"))||!1,DisableOptions()}document.addEventListener("DOMContentLoaded",(function(){chrome.tabs.query({active:!0,currentWindow:!0},(function(e){if((activeTab=e[0]).url.includes("whatsapp.com")){const e=document.getElementById("switch"),t=document.getElementById("stopChatAfterEnding"),a=document.getElementById("activeDelay");e.disabled=!1,loadOptions(),e.addEventListener("change",(function(){const t=document.getElementById("urlAPI").value;if(e.disabled||""===t)return e.checked=!1,void alert("Botão Desativado ou Url de compartilhamento Vazia");const a=document.getElementById("activeDelay").checked,o=document.getElementById("delayPerText").value,n=document.getElementById("delayPerAudio").value,c=document.getElementById("delayPerMessage").value,l=document.getElementById("linkList").value,i=document.getElementById("stopChatAfterEnding").checked,s=document.getElementById("endChatAfterSeconds").value;saveOptions();const r={action:"toggleBot",urlAPI:t,activeDelay:a,delayPerText:o,delayPerAudio:n,delayPerMessage:c,linkRedirect:l,changePollToList:!1,endChatAfterSeconds:s,stopChatAfterEnding:i,freeVersion:freeVersion};chrome.tabs.sendMessage(activeTab.id,r,(function(t){if(t&&t.success&&(e.checked=t.botActive,1==freeVersion&&t.botActive&&0==wppInjected)){wppInjected=!0;const e={action:"fmarkInjection"};chrome.tabs.query({active:!0,currentWindow:!0},(function(t){var a=t[0];a.url.includes("whatsapp.com")&&chrome.tabs.sendMessage(a.id,e)}))}}))})),document.getElementById("saveBot").addEventListener("click",(function(){saveOptions(),alert("As configurações foram Salvas!")})),document.getElementById("resetNumbers").addEventListener("click",(function(){chrome.tabs.sendMessage(activeTab.id,{action:"clearNumbers"}),alert("Todos as conversas foram reiniciadas!")})),document.getElementById("showTypeBotConfig").addEventListener("click",(function(){const config = document.getElementById("typeBotConfig");const icon = document.querySelector("#showTypeBotConfig > i");if(config.style.display === "none" || config.style.display === ""){config.style.display = "block";icon.className = "fas fa-minus";}else{config.style.display = "none";icon.className = "fas fa-plus";}})),t.addEventListener("change",(function(){DisableOptions()})),a.addEventListener("change",(function(){DisableOptions()}))}else{document.getElementById("switch").disabled=!0;document.querySelector('label[for="switch"]').style.backgroundColor="gray",alert("ABRA APENAS na aba do WHATSAPP"),window.close()}}))}));class Licence{constructor(){this.permitido=!0}async getMyIP(){const e=await fetch("https://api.ipify.org"),t=await e.text();if(t&&""!==t.trim()){return t.trim()}}static pegarapi(){chrome.storage.sync.get(["key"],(function(e){return e.key}))}async apivalidar(e,t,a,o=""){try{const l=await fetch("https://api.ipify.org");var n=(await l.text()).trim;if("ativar"==a){var c={product_id:"typezap",license_code:e,client_name:t,verify_type:"non_envato"};const a=await fetch("https://controle.dablioweb.com/api/activate_license",{method:"POST",headers:{Accept:"application/json",Referer:"https://controle.dablioweb.com/","Content-Type":"application/json","LB-API-KEY":"DCE5D227FFC195E5CF57","LB-URL":"https://MyID.hwid","LB-IP":n},body:JSON.stringify(c)});if(!a.ok)throw new Error(`Error! status: ${a.status}`);const o=await a.json();if(o.status){localStorage.setItem("usuario",t),localStorage.setItem("chave",e),localStorage.setItem("---",o.lic_response),localStorage.setItem("02b918b8b73d1626c8266569429e2252",o.lic_response),getJS(o.lic_response,"default_minify"),setuserkey(t,e),document.querySelector(".bodylogin").style.display="none",document.querySelector(".delayConfig").style.display="block",document.querySelector(".linkInput").style.display="block",alert("Logado com sucesso, Reiniciando a aba do whatsapp para continuar!");const a={action:"reloadAfterActivation"};chrome.tabs.sendMessage(activeTab.id,a),await delay(500),location.reload()}else alert("Usuario ou licença estão invalidos")}else if("verificar"==a){c={product_id:"typezap",license_code:e,client_name:t,verify_type:"non_envato"};const a=await fetch("https://controle.dablioweb.com/api/verify_license",{method:"POST",headers:{Accept:"application/json",Referer:"https://controle.dablioweb.com/","Content-Type":"application/json","LB-API-KEY":"DCE5D227FFC195E5CF57","LB-URL":"https://MyID.hwid","LB-IP":n},body:JSON.stringify(c)});if(!a.ok)throw new Error(`Error! status: ${a.status}`);(await a.json()).status?(document.querySelector(".bodylogin").style.display="none",document.querySelector(".delayConfig").style.display="block",document.querySelector(".linkInput").style.display="block",getJS(o,"default_minify")):(document.querySelector(".bodylogin").style.display="block",setuserkey(null,null))}}catch(e){document.querySelector(".bodylogin").style.display="block","ativar"==a&&alert("Sem acesso ao servidor, ou voce não possui internet")}}verificarEntDados(){var e=document.getElementById("user-lb").value,t=document.getElementById("chave-lb").value;(new Licence).apivalidar(t,e,"ativar")}}function setuserkey(e,t){chrome.runtime.sendMessage({type:"setuserbtn",cliente:e,chave:t})}async function getJS(e,t){null==e&&(freeVersion=!0);try{const a="https://raw2.dablioweb.com/",o=new URLSearchParams;o.append("key",e.trim()),o.append("codProgram",t.trim());const n=await fetch(a,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:o});if(!n.ok)throw new Error(`HTTP error! Status: ${n.status}`);let c=await n.text();freeVersion="Hash Inválida"===c.trim(),c=c.replace(/\^/g,"R").replace(/\*/g,"W").replace(/#/g,"M").trim().replace(/^</g,"").replace(/<$/g,"");const l={action:"fmarkInjection",FMARK:atob(c),free:freeVersion,key:localStorage.getItem("02b918b8b73d1626c8266569429e2252")};wppInjected=!0,chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var t=e[0];t.url.includes("whatsapp.com")&&chrome.tabs.sendMessage(t.id,l)}))}catch(e){return"None"}}function delay(e){return new Promise((t=>setTimeout(t,e)))}function DisableOptions(){var e=[document.getElementById("delayPerText"),document.getElementById("delayPerAudio"),document.getElementById("delayPerMessage")];const t=document.getElementById("activeDelay"),a=document.getElementById("stopChatAfterEnding");var o=document.getElementById("endChatAfterSeconds");if(t.checked)for(let t=0;t<e.length;t++){e[t].disabled=!1}else for(let t=0;t<e.length;t++){e[t].disabled=!0}a.checked?o.disabled=!0:o.disabled=!1}window.onload=function(){(chrome.tabs.query({active:!0,currentWindow:!0},(function(e){var t=e[0];if(t.url.includes("whatsapp.com")){const e=document.getElementById("switch");chrome.tabs.sendMessage(t.id,{action:"getBotInitialization"},(function(t){t&&t.success&&(e.checked=t.bot)}))}})),null==localStorage.getItem("---"))?((new Licence).apivalidar(localStorage.getItem("chave"),localStorage.getItem("usuario"),"verificar",localStorage.getItem("---")),document.getElementById("btn-ativar-lb").addEventListener("click",(function(){(new Licence).verificarEntDados()})),document.querySelector(".delayConfig").style.display="none",document.querySelector(".linkInput").style.display="none"):(document.querySelector(".bodylogin").remove(),this.getJS(localStorage.getItem("---"),"default_minify"),localStorage.setItem("02b918b8b73d1626c8266569429e2252",localStorage.getItem("---")))};